# Technical Document: ADC Reading and PWM Control with STM32

## Goal
The goal of this project is to demonstrate how to read analog values using the ADC (Analog-to-Digital Converter) on an STM32 microcontroller, and use those values to adjust the duty cycle of a PWM signal. Additionally, the project will transmit the ADC values and PWM duty cycle over UART to a connected device, allowing for real-time monitoring.

## Objective
- **Read analog data**: Capture analog signals from an ADC channel.
- **Control PWM output**: Use the ADC value to set the duty cycle of a PWM signal generated by a timer.
- **Communication via UART**: Transmit both the ADC value and PWM duty cycle through UART for real-time debugging or monitoring.
- **Periodic updates**: Continuously read the ADC, update the PWM output, and send data over UART at regular intervals.

## Steps

### 1. **System Initialization**
   - **Configure the system clock** to use the High-Speed Internal (HSI) oscillator and set the voltage scaling.
   - **Initialize GPIO** pins for necessary peripherals (ADC, PWM, UART).
   - **Set up the UART communication** with a baud rate of 115200 for transmitting data.
   - **Configure the ADC** to sample analog signals, set the resolution to 16 bits, and trigger the conversion via software.
   - **Set up the PWM generation** using Timer 1, where the PWM signal will be output based on the ADC reading.
   
### 2. **Main Program Flow**
   - **Start ADC conversion**: Trigger the ADC to start converting the analog input into a digital value.
   - **Poll for conversion completion**: Wait for the ADC conversion to complete and obtain the result.
   - **Transmit ADC value via UART**: Send the ADC result (analog-to-digital conversion value) to a connected device via UART for monitoring.
   - **Adjust PWM duty cycle**: Set the PWM duty cycle using the ADC value, thus controlling the output based on the analog input.
   - **Transmit PWM duty cycle via UART**: Send the duty cycle to the connected device via UART for real-time monitoring of the PWM signal.
   - **Introduce a delay**: Wait for a defined period before repeating the process, allowing time for any necessary adjustments or measurements.

### 3. **Error Handling**
   - If any initialization step fails (ADC, Timer, UART), the system will halt in an error state. The error handler will be invoked to prevent further execution, ensuring that any failure is immediately noticed and addressed.

### 4. **Real-Time Data Communication**
   - The UART communication ensures that the system can be monitored in real-time. The ADC value and PWM duty cycle are transmitted over UART, making it easy to observe the system's behavior without needing a debugger or direct hardware access.

## Conclusion
This project provides a basic example of interfacing an ADC with a PWM signal on an STM32 microcontroller. By reading the analog input from the ADC and adjusting the duty cycle of a PWM signal based on this input, the system can dynamically respond to changing conditions. The integration of UART communication further enhances the project by allowing real-time monitoring of both the ADC and PWM outputs.

The code is designed to be easily expandable. Additional ADC channels could be read, more complex PWM waveforms could be generated, and different communication protocols could be added to suit more advanced applications. The use of STM32 HAL functions ensures that the code is portable and maintainable for various STM32 microcontroller models.
